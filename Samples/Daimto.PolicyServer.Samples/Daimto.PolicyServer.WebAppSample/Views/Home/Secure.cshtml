@{
    ViewData["Title"] = "Secure";
}

@model PolicyServer.Client.PolicyResult

<h1>Current User Claims</h1>
@foreach (var id in User.Identities)
{
    <h3>Scheme: @id.AuthenticationType</h3>
    <dl>
        @foreach (var claim in id.Claims)
        {
            <dt>@claim.Type</dt>
            <dd>@claim.Value</dd>
        }
    </dl>
}

<h1>Policy Results</h1>
@if (Model.Roles.Any())
{
    <h2>Roles</h2>
    <ul>
        @foreach (var role in Model.Roles)
        {
            <li>@role</li>
        }
    </ul>
}

@if (Model.Permissions.Any())
{
    <h2>Permission</h2>
    <ul>
        @foreach (var perm in Model.Permissions)
        {
            <li>@perm</li>
        }
    </ul>
}

<h1>Operations</h1>

<p>
    <a asp-action="CookOnly">CookOnly action</a>
</p>
<p>
    <a asp-action="WaitressOnly">WaitressOnly-only action</a>
</p>
<p>
    <a asp-action="CustomerOnly">Customer-only action</a>
</p>

<p>
    <a asp-action="PrepareOrder" asp-all-route-item="Burger" asp-all-route-amount="1">Prepare Burger</a>
</p>
<p>
    <a asp-action="PrepareOrder" asp-all-route-item="Soda" asp-all-route-amount="1">Prepare Soda</a>
</p>
<p>
    <a asp-action="OrderMeal"  asp-all-route-item="Burger" asp-all-route-amount="1">Order meal</a>
</p>
<p>
    <a asp-action="ServeMeal"  asp-all-route-item="Burger" asp-all-route-amount="1" >Serve meal</a>
</p>
